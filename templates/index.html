<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Little Lemon Restaurant</title>
		{% csrf_token %}
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
				line-height: 1.6;
				color: #333;
			}

			header {
				background-color: #495e57;
				color: white;
				padding: 1rem 0;
				text-align: center;
			}

			nav {
				background-color: #f4ce14;
				padding: 1rem;
				text-align: center;
			}

			nav a {
				margin: 0 1rem;
				text-decoration: none;
				color: #495e57;
				font-weight: bold;
			}

			nav a:hover {
				text-decoration: underline;
			}

			.container {
				max-width: 1200px;
				margin: 2rem auto;
				padding: 0 1rem;
			}

			.hero {
				background-color: #495e57;
				color: white;
				padding: 3rem;
				border-radius: 8px;
				text-align: center;
				margin-bottom: 2rem;
			}

			.hero h1 {
				font-size: 2.5rem;
				margin-bottom: 1rem;
			}

			.hero p {
				font-size: 1.1rem;
			}

			.sections {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
				gap: 2rem;
				margin: 2rem 0;
			}

			.card {
				border: 1px solid #ddd;
				padding: 2rem;
				border-radius: 8px;
				box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			}

			.card h2 {
				color: #495e57;
				margin-bottom: 1rem;
			}

			.api-tester {
				background-color: #f9f9f9;
				padding: 2rem;
				border-radius: 8px;
				margin-top: 3rem;
				border: 2px solid #495e57;
			}

			.api-tester h2 {
				color: #495e57;
				margin-bottom: 1.5rem;
			}

			.form-group {
				margin-bottom: 1.5rem;
			}

			.form-group label {
				display: block;
				font-weight: bold;
				margin-bottom: 0.5rem;
				color: #495e57;
			}

			.form-group input,
			.form-group textarea,
			.form-group select {
				width: 100%;
				padding: 0.75rem;
				border: 1px solid #ddd;
				border-radius: 4px;
				font-size: 1rem;
				font-family: inherit;
			}

			.form-group textarea {
				resize: vertical;
				min-height: 100px;
			}

			button {
				background-color: #495e57;
				color: white;
				padding: 0.75rem 1.5rem;
				border: none;
				border-radius: 4px;
				cursor: pointer;
				font-size: 1rem;
				font-weight: bold;
			}

			button:hover {
				background-color: #f4ce14;
				color: #495e57;
			}

			.response-box {
				background-color: #fff;
				border: 1px solid #ddd;
				padding: 1rem;
				border-radius: 4px;
				margin-top: 1rem;
				max-height: 300px;
				overflow-y: auto;
				font-family: "Courier New", monospace;
				font-size: 0.9rem;
				white-space: pre-wrap;
				word-wrap: break-word;
			}

			.error {
				color: #d9534f;
				background-color: #f2dede;
				padding: 1rem;
				border-radius: 4px;
				margin-top: 1rem;
			}

			.success {
				color: #3c763d;
				background-color: #dff0d8;
				padding: 1rem;
				border-radius: 4px;
				margin-top: 1rem;
			}

			footer {
				background-color: #495e57;
				color: white;
				text-align: center;
				padding: 2rem;
				margin-top: 3rem;
			}
		</style>
	</head>
	<body>
		<header>
			<h1>Little Lemon Restaurant</h1>
		</header>

		<nav>
			<a href="#menu">Menu</a>
			<a href="#bookings">Bookings</a>
			<a href="#about">About</a>
			<a href="/api/">API</a>
		</nav>

		<div class="container">
			<div class="hero">
				<h1>Welcome to Little Lemon</h1>
				<p>
					Experience authentic Mediterranean cuisine in a warm, inviting
					atmosphere
				</p>
			</div>

			<div class="sections">
				<div class="card">
					<h2 id="menu">üçΩÔ∏è Menu API</h2>
					<p><strong>Base Path:</strong> <code>/api/menu/</code></p>
					<ul style="margin-left: 1.5rem; margin-top: 1rem">
						<li>GET /api/menu/ - List all items</li>
						<li>GET /api/menu/{id}/ - Get item details</li>
						<li>POST /api/menu/ - Create item (auth)</li>
						<li>PUT /api/menu/{id}/ - Update item (auth)</li>
						<li>DELETE /api/menu/{id}/ - Delete item (auth)</li>
					</ul>
				</div>

				<div class="card">
					<h2 id="bookings">üìÖ Bookings API</h2>
					<p><strong>Base Path:</strong> <code>/api/bookings/</code></p>
					<ul style="margin-left: 1.5rem; margin-top: 1rem">
						<li>GET /api/bookings/ - List your bookings (auth)</li>
						<li>GET /api/bookings/{id}/ - Get booking details (auth)</li>
						<li>POST /api/bookings/ - Create booking (auth)</li>
						<li>PUT /api/bookings/{id}/ - Update booking (auth)</li>
						<li>DELETE /api/bookings/{id}/ - Delete booking (auth)</li>
					</ul>
				</div>

				<div class="card">
					<h2>üîê Authentication API</h2>
					<p><strong>Endpoints:</strong></p>
					<ul style="margin-left: 1.5rem; margin-top: 1rem">
						<li>POST /api/auth/register/ - Register user</li>
						<li>POST /api/auth/login/ - Login & get token</li>
						<li>POST /api-token-auth/ - Get auth token</li>
					</ul>
				</div>

				<div class="card">
					<h2>‚öôÔ∏è Admin Panel</h2>
					<p>
						Access the Django admin interface to manage menu items, bookings,
						users, and other site content.
					</p>
					<p><a href="/admin/">Go to Admin ‚Üí</a></p>
				</div>

				<div class="card">
					<h2>üìö API Documentation</h2>
					<p><strong>Base URL:</strong> <code>http://localhost:8000</code></p>
					<p>All authenticated endpoints require:</p>
					<p><code>Authorization: Token YOUR_TOKEN</code></p>
					<p><a href="/api/">View Full API ‚Üí</a></p>
				</div>

				<div class="card">
					<h2 id="about">‚ÑπÔ∏è About Us</h2>
					<p>
						Little Lemon has been serving the finest Mediterranean dishes to our
						beloved community.
					</p>
				</div>
			</div>

			<div class="api-tester">
				<h2>üß™ API Tester</h2>
				<p>
					Test all API endpoints directly from this interface without using
					third-party tools.
				</p>

				<div class="form-group">
					<label for="apiEndpoint">Select API Endpoint:</label>
					<select id="apiEndpoint" onchange="updateForm()">
						<option value="">-- Choose an endpoint --</option>
						<optgroup label="Authentication">
							<option value="register">
								POST /api/auth/register/ - Register User
							</option>
							<option value="login">POST /api/auth/login/ - Login User</option>
							<option value="token-auth">
								POST /api-token-auth/ - Get Token
							</option>
						</optgroup>
						<optgroup label="Menu (no auth required for GET)">
							<option value="menu-list">
								GET /api/menu/ - List Menu Items
							</option>
							<option value="menu-detail">
								GET /api/menu/{id}/ - Get Menu Item
							</option>
							<option value="menu-create">
								POST /api/menu/ - Create Menu Item
							</option>
							<option value="menu-update">
								PUT /api/menu/{id}/ - Update Menu Item
							</option>
							<option value="menu-delete">
								DELETE /api/menu/{id}/ - Delete Menu Item
							</option>
						</optgroup>
						<optgroup label="Bookings (auth required)">
							<option value="bookings-list">
								GET /api/bookings/ - List Bookings
							</option>
							<option value="bookings-detail">
								GET /api/bookings/{id}/ - Get Booking
							</option>
							<option value="bookings-create">
								POST /api/bookings/ - Create Booking
							</option>
							<option value="bookings-update">
								PUT /api/bookings/{id}/ - Update Booking
							</option>
							<option value="bookings-delete">
								DELETE /api/bookings/{id}/ - Delete Booking
							</option>
						</optgroup>
					</select>
				</div>

				<div id="dynamicForm"></div>

				<button onclick="testAPI()">Send Request</button>

				<div id="response"></div>
			</div>
		</div>

		<footer>
			<p>&copy; 2024 Little Lemon Restaurant. All rights reserved.</p>
			<p>Contact: info@littlelemon.com | Phone: (555) 123-4567</p>
		</footer>

		<script>
			function getCSRFToken() {
				const name = "csrftoken";
				let cookieValue = null;
				if (document.cookie && document.cookie !== "") {
					const cookies = document.cookie.split(";");
					for (let i = 0; i < cookies.length; i++) {
						const cookie = cookies[i].trim();
						if (cookie.substring(0, name.length + 1) === name + "=") {
							cookieValue = decodeURIComponent(
								cookie.substring(name.length + 1)
							);
							break;
						}
					}
				}
				return cookieValue;
			}

			function updateForm() {
				const endpoint = document.getElementById("apiEndpoint").value;
				const dynamicForm = document.getElementById("dynamicForm");
				dynamicForm.innerHTML = "";

				switch (endpoint) {
					case "register":
						dynamicForm.innerHTML = `
							<div class="form-group">
								<label for="reg-username">Username:</label>
								<input type="text" id="reg-username" placeholder="Enter username">
							</div>
							<div class="form-group">
								<label for="reg-password">Password:</label>
								<input type="password" id="reg-password" placeholder="Enter password">
							</div>
							<div class="form-group">
								<label for="reg-email">Email:</label>
								<input type="email" id="reg-email" placeholder="Enter email">
							</div>
							<div class="form-group">
								<label for="reg-first-name">First Name:</label>
								<input type="text" id="reg-first-name" placeholder="Enter first name">
							</div>
							<div class="form-group">
								<label for="reg-last-name">Last Name:</label>
								<input type="text" id="reg-last-name" placeholder="Enter last name">
							</div>
						`;
						break;
					case "login":
						dynamicForm.innerHTML = `
							<div class="form-group">
								<label for="login-username">Username:</label>
								<input type="text" id="login-username" placeholder="Enter your username">
							</div>
							<div class="form-group">
								<label for="login-password">Password:</label>
								<input type="password" id="login-password" placeholder="Enter your password">
							</div>
						`;
						break;
					case "token-auth":
						dynamicForm.innerHTML = `
							<div class="form-group">
								<label for="username">Username:</label>
								<input type="text" id="username" placeholder="Enter your username">
							</div>
							<div class="form-group">
								<label for="password">Password:</label>
								<input type="password" id="password" placeholder="Enter your password">
							</div>
						`;
						break;
					case "menu-detail":
					case "menu-update":
					case "menu-delete":
						dynamicForm.innerHTML = `
							<div class="form-group">
								<label for="menu-id">Menu Item ID:</label>
								<input type="number" id="menu-id" placeholder="Enter item ID">
							</div>
						`;
						if (endpoint === "menu-update") {
							dynamicForm.innerHTML += `
								<div class="form-group">
									<label for="menu-title">Title:</label>
									<input type="text" id="menu-title" placeholder="Enter item title">
								</div>
								<div class="form-group">
									<label for="menu-price">Price:</label>
									<input type="number" id="menu-price" step="0.01" placeholder="Enter item price">
								</div>
								<div class="form-group">
									<label for="menu-inventory">Inventory:</label>
									<input type="number" id="menu-inventory" placeholder="Enter inventory count">
								</div>
								<div class="form-group">
									<label for="menu-token">Auth Token (required):</label>
									<input type="text" id="menu-token" placeholder="Paste your auth token here">
								</div>
							`;
						} else if (endpoint === "menu-delete") {
							dynamicForm.innerHTML += `
								<div class="form-group">
									<label for="menu-token">Auth Token (required):</label>
									<input type="text" id="menu-token" placeholder="Paste your auth token here">
								</div>
							`;
						}
						break;
					case "menu-create":
						dynamicForm.innerHTML = `
							<div class="form-group">
								<label for="menu-title">Title:</label>
								<input type="text" id="menu-title" placeholder="Enter item title">
							</div>
							<div class="form-group">
								<label for="menu-price">Price:</label>
								<input type="number" id="menu-price" step="0.01" placeholder="Enter item price">
							</div>
							<div class="form-group">
								<label for="menu-inventory">Inventory:</label>
								<input type="number" id="menu-inventory" placeholder="Enter inventory count">
							</div>
							<div class="form-group">
								<label for="menu-token">Auth Token (required):</label>
								<input type="text" id="menu-token" placeholder="Paste your auth token here">
							</div>
						`;
						break;
					case "bookings-list":
						dynamicForm.innerHTML = `
							<div class="form-group">
								<label for="booking-token">Auth Token (required):</label>
								<input type="text" id="booking-token" placeholder="Paste your auth token here">
							</div>
						`;
						break;
					case "bookings-detail":
					case "bookings-update":
					case "bookings-delete":
						dynamicForm.innerHTML = `
							<div class="form-group">
								<label for="booking-id">Booking ID:</label>
								<input type="number" id="booking-id" placeholder="Enter booking ID">
							</div>
						`;
						if (endpoint === "bookings-update") {
							dynamicForm.innerHTML += `
								<div class="form-group">
									<label for="booking-name">Name:</label>
									<input type="text" id="booking-name" placeholder="Enter guest name">
								</div>
								<div class="form-group">
									<label for="booking-guests">Number of Guests:</label>
									<input type="number" id="booking-guests" placeholder="Enter number of guests">
								</div>
								<div class="form-group">
									<label for="booking-date">Date:</label>
									<input type="date" id="booking-date">
								</div>
								<div class="form-group">
									<label for="booking-time">Time:</label>
									<input type="time" id="booking-time">
								</div>
								<div class="form-group">
									<label for="booking-token">Auth Token (required):</label>
									<input type="text" id="booking-token" placeholder="Paste your auth token here">
								</div>
							`;
						} else if (endpoint === "bookings-delete") {
							dynamicForm.innerHTML += `
								<div class="form-group">
									<label for="booking-token">Auth Token (required):</label>
									<input type="text" id="booking-token" placeholder="Paste your auth token here">
								</div>
							`;
						} else {
							dynamicForm.innerHTML += `
								<div class="form-group">
									<label for="booking-token">Auth Token (required):</label>
									<input type="text" id="booking-token" placeholder="Paste your auth token here">
								</div>
							`;
						}
						break;
					case "bookings-create":
						dynamicForm.innerHTML = `
							<div class="form-group">
								<label for="booking-name">Name:</label>
								<input type="text" id="booking-name" placeholder="Enter guest name">
							</div>
							<div class="form-group">
								<label for="booking-guests">Number of Guests:</label>
								<input type="number" id="booking-guests" placeholder="Enter number of guests">
							</div>
							<div class="form-group">
								<label for="booking-date">Date:</label>
								<input type="date" id="booking-date">
							</div>
							<div class="form-group">
								<label for="booking-time">Time:</label>
								<input type="time" id="booking-time">
							</div>
							<div class="form-group">
								<label for="booking-token">Auth Token (required):</label>
								<input type="text" id="booking-token" placeholder="Paste your auth token here">
							</div>
						`;
						break;
				}
			}

			async function testAPI() {
				const endpoint = document.getElementById("apiEndpoint").value;
				const responseDiv = document.getElementById("response");

				if (!endpoint) {
					responseDiv.innerHTML =
						'<div class="error">Please select an endpoint</div>';
					return;
				}

				let url = "";
				let method = "GET";
				let body = null;
				let headers = {
					"Content-Type": "application/json",
				};

				try {
					switch (endpoint) {
						case "register":
							url = "/api/auth/register/";
							method = "POST";
							const regUsername = document.getElementById("reg-username").value;
							const regPassword = document.getElementById("reg-password").value;
							const regEmail = document.getElementById("reg-email").value;
							const regFirstName =
								document.getElementById("reg-first-name").value;
							const regLastName =
								document.getElementById("reg-last-name").value;
							if (!regUsername || !regPassword || !regEmail) {
								responseDiv.innerHTML =
									'<div class="error">Please fill all required fields</div>';
								return;
							}
							body = JSON.stringify({
								username: regUsername,
								password: regPassword,
								email: regEmail,
								first_name: regFirstName || "",
								last_name: regLastName || "",
							});
							headers["X-CSRFToken"] = getCSRFToken();
							break;
						case "login":
							url = "/api/auth/login/";
							method = "POST";
							const loginUsername =
								document.getElementById("login-username").value;
							const loginPassword =
								document.getElementById("login-password").value;
							if (!loginUsername || !loginPassword) {
								responseDiv.innerHTML =
									'<div class="error">Please enter username and password</div>';
								return;
							}
							body = JSON.stringify({
								username: loginUsername,
								password: loginPassword,
							});
							headers["X-CSRFToken"] = getCSRFToken();
							break;
						case "token-auth":
							url = "/api-token-auth/";
							method = "POST";
							const username = document.getElementById("username").value;
							const password = document.getElementById("password").value;
							if (!username || !password) {
								responseDiv.innerHTML =
									'<div class="error">Please enter username and password</div>';
								return;
							}
							body = JSON.stringify({ username, password });
							headers["X-CSRFToken"] = getCSRFToken();
							break;
						case "menu-list":
							url = "/api/menu/";
							break;
						case "menu-detail":
							const menuDetailId = document.getElementById("menu-id").value;
							if (!menuDetailId) {
								responseDiv.innerHTML =
									'<div class="error">Please enter menu item ID</div>';
								return;
							}
							url = `/api/menu/${menuDetailId}/`;
							break;
						case "menu-create":
							url = "/api/menu/";
							method = "POST";
							const menuTitle = document.getElementById("menu-title").value;
							const menuPrice = document.getElementById("menu-price").value;
							const menuInventory =
								document.getElementById("menu-inventory").value;
							const menuToken = document.getElementById("menu-token").value;
							if (!menuTitle || !menuPrice || !menuInventory || !menuToken) {
								responseDiv.innerHTML =
									'<div class="error">Please fill all required fields</div>';
								return;
							}
							body = JSON.stringify({
								title: menuTitle,
								price: menuPrice,
								inventory: menuInventory,
							});
							headers["Authorization"] = `Token ${menuToken}`;
							headers["X-CSRFToken"] = getCSRFToken();
							break;
						case "menu-update":
							const menuUpdateId = document.getElementById("menu-id").value;
							const menuUpdateTitle =
								document.getElementById("menu-title").value;
							const menuUpdatePrice =
								document.getElementById("menu-price").value;
							const menuUpdateInventory =
								document.getElementById("menu-inventory").value;
							const menuUpdateToken =
								document.getElementById("menu-token").value;
							if (
								!menuUpdateId ||
								!menuUpdateTitle ||
								!menuUpdatePrice ||
								!menuUpdateToken
							) {
								responseDiv.innerHTML =
									'<div class="error">Please fill all required fields</div>';
								return;
							}
							url = `/api/menu/${menuUpdateId}/`;
							method = "PUT";
							body = JSON.stringify({
								title: menuUpdateTitle,
								price: menuUpdatePrice,
								inventory: menuUpdateInventory,
							});
							headers["Authorization"] = `Token ${menuUpdateToken}`;
							headers["X-CSRFToken"] = getCSRFToken();
							break;
						case "menu-delete":
							const menuDeleteId = document.getElementById("menu-id").value;
							const menuDeleteToken =
								document.getElementById("menu-token").value;
							if (!menuDeleteId || !menuDeleteToken) {
								responseDiv.innerHTML =
									'<div class="error">Please enter menu item ID and token</div>';
								return;
							}
							url = `/api/menu/${menuDeleteId}/`;
							method = "DELETE";
							headers["Authorization"] = `Token ${menuDeleteToken}`;
							headers["X-CSRFToken"] = getCSRFToken();
							break;
						case "bookings-list":
							url = "/api/bookings/";
							const bookingListToken =
								document.getElementById("booking-token").value;
							if (!bookingListToken) {
								responseDiv.innerHTML =
									'<div class="error">Please enter your auth token</div>';
								return;
							}
							headers["Authorization"] = `Token ${bookingListToken}`;
							break;
						case "bookings-detail":
							const bookingDetailId =
								document.getElementById("booking-id").value;
							const bookingDetailToken =
								document.getElementById("booking-token").value;
							if (!bookingDetailId || !bookingDetailToken) {
								responseDiv.innerHTML =
									'<div class="error">Please enter booking ID and token</div>';
								return;
							}
							url = `/api/bookings/${bookingDetailId}/`;
							headers["Authorization"] = `Token ${bookingDetailToken}`;
							break;
						case "bookings-create":
							url = "/api/bookings/";
							method = "POST";
							const bookingName = document.getElementById("booking-name").value;
							const bookingGuests =
								document.getElementById("booking-guests").value;
							const bookingDate = document.getElementById("booking-date").value;
							const bookingTime = document.getElementById("booking-time").value;
							const bookingToken =
								document.getElementById("booking-token").value;
							if (
								!bookingName ||
								!bookingGuests ||
								!bookingDate ||
								!bookingTime ||
								!bookingToken
							) {
								responseDiv.innerHTML =
									'<div class="error">Please fill all required fields</div>';
								return;
							}
							body = JSON.stringify({
								name: bookingName,
								no_of_guests: bookingGuests,
								booking_date: bookingDate,
								booking_time: bookingTime,
							});
							headers["Authorization"] = `Token ${bookingToken}`;
							headers["X-CSRFToken"] = getCSRFToken();
							break;
						case "bookings-update":
							const bookingUpdateId =
								document.getElementById("booking-id").value;
							const bookingUpdateName =
								document.getElementById("booking-name").value;
							const bookingUpdateGuests =
								document.getElementById("booking-guests").value;
							const bookingUpdateDate =
								document.getElementById("booking-date").value;
							const bookingUpdateTime =
								document.getElementById("booking-time").value;
							const bookingUpdateToken =
								document.getElementById("booking-token").value;
							if (
								!bookingUpdateId ||
								!bookingUpdateName ||
								!bookingUpdateGuests ||
								!bookingUpdateToken
							) {
								responseDiv.innerHTML =
									'<div class="error">Please fill all required fields</div>';
								return;
							}
							url = `/api/bookings/${bookingUpdateId}/`;
							method = "PUT";
							body = JSON.stringify({
								name: bookingUpdateName,
								no_of_guests: bookingUpdateGuests,
								booking_date: bookingUpdateDate,
								booking_time: bookingUpdateTime,
							});
							headers["Authorization"] = `Token ${bookingUpdateToken}`;
							headers["X-CSRFToken"] = getCSRFToken();
							break;
						case "bookings-delete":
							const bookingDeleteId =
								document.getElementById("booking-id").value;
							const bookingDeleteToken =
								document.getElementById("booking-token").value;
							if (!bookingDeleteId || !bookingDeleteToken) {
								responseDiv.innerHTML =
									'<div class="error">Please enter booking ID and token</div>';
								return;
							}
							url = `/api/bookings/${bookingDeleteId}/`;
							method = "DELETE";
							headers["Authorization"] = `Token ${bookingDeleteToken}`;
							headers["X-CSRFToken"] = getCSRFToken();
							break;
					}

					responseDiv.innerHTML = '<div class="success">Loading...</div>';

					const response = await fetch(url, {
						method: method,
						headers: headers,
						body: body,
					});

					const data = await response.json();

					if (response.ok) {
						responseDiv.innerHTML = `
							<div class="success">
								<strong>‚úì Status: ${response.status} ${response.statusText}</strong>
								<div class="response-box">${JSON.stringify(data, null, 2)}</div>
							</div>
						`;
					} else {
						responseDiv.innerHTML = `
							<div class="error">
								<strong>‚úó Status: ${response.status} ${response.statusText}</strong>
								<div class="response-box">${JSON.stringify(data, null, 2)}</div>
							</div>
						`;
					}
				} catch (error) {
					responseDiv.innerHTML = `
						<div class="error">
							<strong>Error:</strong>
							<div class="response-box">${error.message}</div>
						</div>
					`;
				}
			}

			// Allow Enter key to trigger API test
			document.addEventListener("keypress", function (e) {
				if (
					e.key === "Enter" &&
					document.activeElement.tagName !== "TEXTAREA"
				) {
					testAPI();
				}
			});
		</script>
	</body>
</html>
